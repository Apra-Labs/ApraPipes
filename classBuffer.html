<!-- HTML header for doxygen 1.10.0-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ApraPipes: Buffer Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
    <tbody>
        <tr id="projectrow">
            <td style="text-align: right;">
                <img src="apralogo.png" alt="Logo" style="max-height: 50px; max-width: 100px;">
            </td>
            <td id="projectalign">
                <div id="projectname">ApraPipes<span id="projectnumber">&nbsp;1.0</span></div>
            </td>
        </tr>
    </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('classBuffer.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classBuffer-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">Buffer Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Class representing a buffer.  
 <a href="#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="H264DecoderV4L2Helper_8h_source.html">H264DecoderV4L2Helper.h</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for Buffer:</div>
<div class="dyncontent">
<div class="center"><img src="classBuffer__coll__graph.png" border="0" usemap="#aBuffer_coll__map" alt="Collaboration graph"/></div>
<map name="aBuffer_coll__map" id="aBuffer_coll__map">
<area shape="rect" title="Class representing a buffer." alt="" coords="5,422,169,687"/>
<area shape="rect" href="structBuffer_1_1BufferPlane.html" title=" " alt="" coords="27,214,147,359"/>
<area shape="poly" title=" " alt="" coords="90,359,90,406,85,406,85,359"/>
<area shape="rect" href="structBuffer_1_1BufferPlaneFormat.html" title=" " alt="" coords="7,5,168,151"/>
<area shape="poly" title=" " alt="" coords="90,150,90,197,85,197,85,150"/>
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structBuffer_1_1BufferPlane.html">BufferPlane</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structBuffer_1_1BufferPlaneFormat.html">BufferPlaneFormat</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ae7ef2cd201190fde551dcb902627112b" id="r_ae7ef2cd201190fde551dcb902627112b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae7ef2cd201190fde551dcb902627112b">Buffer</a> ()</td></tr>
<tr class="separator:ae7ef2cd201190fde551dcb902627112b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1705f0bb0cd761c436631af24e0242ca" id="r_a1705f0bb0cd761c436631af24e0242ca"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1705f0bb0cd761c436631af24e0242ca">Buffer</a> (<a class="el" href="#a503cae4db48721184bb9f07e65829ef2">enum</a> <a class="el" href="#a503cae4db48721184bb9f07e65829ef2">v4l2_buf_type</a> <a class="el" href="#a2765e361092daf74ecf5892d19807f54">buf_type</a>, <a class="el" href="#a503cae4db48721184bb9f07e65829ef2">enum</a> <a class="el" href="#a503cae4db48721184bb9f07e65829ef2">v4l2_memory</a> <a class="el" href="#a7a3e9a3e9657d4fa4e2c3eb6f88e234b">memory_type</a>, <a class="el" href="#a503cae4db48721184bb9f07e65829ef2">uint32_t</a> <a class="el" href="#a2b2a909b1bef94995dc0cdad022d8505">index</a>)</td></tr>
<tr class="separator:a1705f0bb0cd761c436631af24e0242ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a53ef7b2ce3def1c2ecc85cf16257a1" id="r_a6a53ef7b2ce3def1c2ecc85cf16257a1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6a53ef7b2ce3def1c2ecc85cf16257a1">Buffer</a> (<a class="el" href="#a503cae4db48721184bb9f07e65829ef2">enum</a> <a class="el" href="#a503cae4db48721184bb9f07e65829ef2">v4l2_buf_type</a> <a class="el" href="#a2765e361092daf74ecf5892d19807f54">buf_type</a>, <a class="el" href="#a503cae4db48721184bb9f07e65829ef2">enum</a> <a class="el" href="#a503cae4db48721184bb9f07e65829ef2">v4l2_memory</a> <a class="el" href="#a7a3e9a3e9657d4fa4e2c3eb6f88e234b">memory_type</a>, <a class="el" href="#a503cae4db48721184bb9f07e65829ef2">uint32_t</a> <a class="el" href="#a08a43c825b6c73f0cb3c7771f5629a1a">n_planes</a>, <a class="el" href="structBuffer_1_1BufferPlaneFormat.html">BufferPlaneFormat</a> *fmt, <a class="el" href="#a503cae4db48721184bb9f07e65829ef2">uint32_t</a> <a class="el" href="#a2b2a909b1bef94995dc0cdad022d8505">index</a>)</td></tr>
<tr class="separator:a6a53ef7b2ce3def1c2ecc85cf16257a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59b8743e4a5f731bdd0c4185c9ef263b" id="r_a59b8743e4a5f731bdd0c4185c9ef263b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a59b8743e4a5f731bdd0c4185c9ef263b">~Buffer</a> ()</td></tr>
<tr class="separator:a59b8743e4a5f731bdd0c4185c9ef263b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a503cae4db48721184bb9f07e65829ef2" id="r_a503cae4db48721184bb9f07e65829ef2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a503cae4db48721184bb9f07e65829ef2">map</a> ()</td></tr>
<tr class="separator:a503cae4db48721184bb9f07e65829ef2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaeecba2e74f8797e81816c433f7d573e" id="r_aaeecba2e74f8797e81816c433f7d573e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="#a503cae4db48721184bb9f07e65829ef2">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aaeecba2e74f8797e81816c433f7d573e">unmap</a> ()</td></tr>
<tr class="separator:aaeecba2e74f8797e81816c433f7d573e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6002af2b41087f5cd575e6f49b5a0ea8" id="r_a6002af2b41087f5cd575e6f49b5a0ea8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="#a503cae4db48721184bb9f07e65829ef2">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6002af2b41087f5cd575e6f49b5a0ea8">fill_buffer_plane_format</a> (<a class="el" href="#a503cae4db48721184bb9f07e65829ef2">uint32_t</a> *<a class="el" href="#a503cae4db48721184bb9f07e65829ef2">num_planes</a>, <a class="el" href="structBuffer_1_1BufferPlaneFormat.html">Buffer::BufferPlaneFormat</a> *<a class="el" href="#a503cae4db48721184bb9f07e65829ef2">planefmts</a>, <a class="el" href="#a503cae4db48721184bb9f07e65829ef2">uint32_t</a> width, <a class="el" href="#a503cae4db48721184bb9f07e65829ef2">uint32_t</a> height, <a class="el" href="#a503cae4db48721184bb9f07e65829ef2">uint32_t</a> <a class="el" href="#a503cae4db48721184bb9f07e65829ef2">raw_pixfmt</a>)</td></tr>
<tr class="separator:a6002af2b41087f5cd575e6f49b5a0ea8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a2765e361092daf74ecf5892d19807f54" id="r_a2765e361092daf74ecf5892d19807f54"><td class="memItemLeft" align="right" valign="top"><a class="el" href="#a503cae4db48721184bb9f07e65829ef2">enum</a> <a class="el" href="#a503cae4db48721184bb9f07e65829ef2">v4l2_buf_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2765e361092daf74ecf5892d19807f54">buf_type</a></td></tr>
<tr class="separator:a2765e361092daf74ecf5892d19807f54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a3e9a3e9657d4fa4e2c3eb6f88e234b" id="r_a7a3e9a3e9657d4fa4e2c3eb6f88e234b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="#a503cae4db48721184bb9f07e65829ef2">enum</a> <a class="el" href="#a503cae4db48721184bb9f07e65829ef2">v4l2_memory</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7a3e9a3e9657d4fa4e2c3eb6f88e234b">memory_type</a></td></tr>
<tr class="separator:a7a3e9a3e9657d4fa4e2c3eb6f88e234b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b2a909b1bef94995dc0cdad022d8505" id="r_a2b2a909b1bef94995dc0cdad022d8505"><td class="memItemLeft" align="right" valign="top"><a class="el" href="#a503cae4db48721184bb9f07e65829ef2">uint32_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2b2a909b1bef94995dc0cdad022d8505">index</a></td></tr>
<tr class="separator:a2b2a909b1bef94995dc0cdad022d8505"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08a43c825b6c73f0cb3c7771f5629a1a" id="r_a08a43c825b6c73f0cb3c7771f5629a1a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="#a503cae4db48721184bb9f07e65829ef2">uint32_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a08a43c825b6c73f0cb3c7771f5629a1a">n_planes</a></td></tr>
<tr class="separator:a08a43c825b6c73f0cb3c7771f5629a1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95709171c4c8c9dfa7991bceec271e15" id="r_a95709171c4c8c9dfa7991bceec271e15"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structBuffer_1_1BufferPlane.html">BufferPlane</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a95709171c4c8c9dfa7991bceec271e15">planes</a> [MAX_PLANES]</td></tr>
<tr class="separator:a95709171c4c8c9dfa7991bceec271e15"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-attribs" name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a000d51a210f48a064afc1e2b4db1482b" id="r_a000d51a210f48a064afc1e2b4db1482b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="#a503cae4db48721184bb9f07e65829ef2">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a000d51a210f48a064afc1e2b4db1482b">mapped</a></td></tr>
<tr class="separator:a000d51a210f48a064afc1e2b4db1482b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Class representing a buffer. </p>
<p>The <a class="el" href="classBuffer.html" title="Class representing a buffer.">Buffer</a> class is modeled on the basis of the <code>v4l2_buffer</code> structure. The buffer has <code>buf_type</code> <code>v4l2_buf_type</code>, <code>memory_type</code> <code>v4l2_memory</code>, and an index. It contains an <a class="el" href="structBuffer_1_1BufferPlane.html">BufferPlane</a> array similar to the array of <code>v4l2_plane</code> structures in <code>v4l2_buffer.m.planes</code>. It also contains a corresponding <a class="el" href="structBuffer_1_1BufferPlaneFormat.html">BufferPlaneFormat</a> array that describes the format of each of the planes.</p>
<p>In the case of a V4L2 MMAP, this class provides convenience methods for mapping or unmapping the contents of the buffer to or from memory, allocating or deallocating software memory depending on its format. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ae7ef2cd201190fde551dcb902627112b" name="ae7ef2cd201190fde551dcb902627112b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7ef2cd201190fde551dcb902627112b">&#9670;&#160;</a></span>Buffer() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Buffer::Buffer </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a1705f0bb0cd761c436631af24e0242ca" name="a1705f0bb0cd761c436631af24e0242ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1705f0bb0cd761c436631af24e0242ca">&#9670;&#160;</a></span>Buffer() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Buffer::Buffer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="#a503cae4db48721184bb9f07e65829ef2">enum</a> <a class="el" href="#a503cae4db48721184bb9f07e65829ef2">v4l2_buf_type</a></td>          <td class="paramname"><span class="paramname"><em>buf_type</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="#a503cae4db48721184bb9f07e65829ef2">enum</a> <a class="el" href="#a503cae4db48721184bb9f07e65829ef2">v4l2_memory</a></td>          <td class="paramname"><span class="paramname"><em>memory_type</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="#a503cae4db48721184bb9f07e65829ef2">uint32_t</a></td>          <td class="paramname"><span class="paramname"><em>index</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Execution command: ./decode_sample elementary_h264file.264 output_raw_file.yuv V4L2 H264 Video Decoder Sample</p>
<p>The video decoder device node isls /dev/nvhost-nvdec</p>
<p>In this sample: </p>
<h2><a class="anchor" id="autotoc_md0"></a>
Pixel Formats</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter">OUTPUT PLANE   </th><th class="markdownTableHeadCenter">CAPTURE PLANE    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">V4L2_PIX_FMT_H264   </td><td class="markdownTableBodyCenter">V4L2_PIX_FMT_NV12M   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md1"></a>
Memory Type</h2>
<p>| OUTPUT PLANE | CAPTURE PLANE :-----&mdash;: | :-------&mdash;: | :--------&mdash;: MEMORY | V4L2_MEMORY_MMAP | V4L2_MEMORY_DMABUF</p>
<h2><a class="anchor" id="autotoc_md2"></a>
Supported Controls</h2>
<ul>
<li><a class="el" href="#a503cae4db48721184bb9f07e65829ef2">V4L2_CID_MPEG_VIDEO_DISABLE_COMPLETE_FRAME_INPUT</a></li>
<li>V4L2_CID_MIN_BUFFERS_FOR_CAPTURE (Get the minimum buffers to be allocated on capture plane. Read-only. Valid after <a class="el" href="#a503cae4db48721184bb9f07e65829ef2">V4L2_EVENT_RESOLUTION_CHANGE</a>)</li>
</ul>
<h2><a class="anchor" id="autotoc_md3"></a>
Supported Events</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Event   </th><th class="markdownTableHeadCenter">Purpose    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="#a503cae4db48721184bb9f07e65829ef2">V4L2_EVENT_RESOLUTION_CHANGE</a>   </td><td class="markdownTableBodyCenter">Resolution of the stream has changed.   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md4"></a>
Opening the Decoder</h2>
<p>The decoder device node is opened through the v4l2_open IOCTL call. After opening the device, the application calls VIDIOC_QUERYCAP to identify the driver capabilities.</p>
<h2><a class="anchor" id="autotoc_md5"></a>
Subscribing events and setting up the planes</h2>
<p>The application subscribes to the V4L2_EVENT_RESOLUTION_CHANGE event, to detect the change in the resolution and handle the plane buffers accordingly. It calls VIDIOC_S_FMT to setup the formats required on OUTPUT PLANE and CAPTURE PLANE for the data negotiation between the former and the driver.</p>
<h2><a class="anchor" id="autotoc_md6"></a>
Setting Controls</h2>
<p>The application gets/sets the properties of the decoder by setting the controls, calling VIDIOC_S_EXT_CTRLS, VIDIOC_G_CTRL.</p>
<h2><a class="anchor" id="autotoc_md7"></a>
Buffer Management</h2>
<p>Buffers are requested on the OUTPUT PLANE by the application, calling VIDIOC_REQBUFS. The actual buffers allocated by the decoder are then queried and exported as FD for the DMA-mapped buffer while mapped for Mmaped buffer. Status STREAMON is called on both planes to signal the decoder for processing.</p>
<p>Application continuously queues the encoded stream in the allocated OUTPUT PLANE buffer and dequeues the next empty buffer fed into the decoder. The decoder decodes the buffer and triggers the resolution change event on the capture plane</p>
<h2><a class="anchor" id="autotoc_md8"></a>
Handling Resolution Change Events</h2>
<p>When the decoder generates a V4L2_EVENT_RESOLUTION_CHANGE event, the application calls STREAMOFF on the capture plane to tell the decoder to deallocate the current buffers by calling REQBUF with count zero, get the new capture plane format calling VIDIOC_G_FMT, and then proceed with setting up the buffers for the capture plane.</p>
<p>The decoding thread blocks on the DQ buffer call, which returns either after a successful decoded raw buffer or after a specific timeout.</p>
<h2><a class="anchor" id="autotoc_md9"></a>
EOS Handling</h2>
<p>For sending EOS and receiving EOS from the decoder, the application must</p><ul>
<li>Send EOS to the decoder by queueing on the output plane a buffer with bytesused = 0 for the 0th plane (<code>v4l2_buffer.m.planes[0].bytesused = 0</code>).</li>
<li>Dequeues buffers on the output plane until it gets a buffer with bytesused = 0 for the 0th plane (<code>v4l2_buffer.m.planes[0].bytesused == 0</code>)</li>
<li>Dequeues buffers on the capture plane until it gets a buffer with bytesused = 0 for the 0th plane. After the last buffer on the capture plane is dequeued, set STREAMOFF on both planes and destroy the allocated buffers. </li>
</ul>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classBuffer_a1705f0bb0cd761c436631af24e0242ca_cgraph.png" border="0" usemap="#aclassBuffer_a1705f0bb0cd761c436631af24e0242ca_cgraph" alt=""/></div>
<map name="aclassBuffer_a1705f0bb0cd761c436631af24e0242ca_cgraph" id="aclassBuffer_a1705f0bb0cd761c436631af24e0242ca_cgraph">
<area shape="rect" title=" " alt="" coords="5,29,101,55"/>
<area shape="rect" href="classBuffer.html#a503cae4db48721184bb9f07e65829ef2" title=" " alt="" coords="149,29,235,55"/>
<area shape="poly" title=" " alt="" coords="101,40,133,40,133,45,101,45"/>
<area shape="poly" title=" " alt="" coords="168,30,163,21,166,11,176,5,192,3,209,5,218,12,215,16,207,10,192,8,178,10,170,14,169,20,172,28"/>
</map>
</div>

</div>
</div>
<a id="a6a53ef7b2ce3def1c2ecc85cf16257a1" name="a6a53ef7b2ce3def1c2ecc85cf16257a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a53ef7b2ce3def1c2ecc85cf16257a1">&#9670;&#160;</a></span>Buffer() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Buffer::Buffer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="#a503cae4db48721184bb9f07e65829ef2">enum</a> <a class="el" href="#a503cae4db48721184bb9f07e65829ef2">v4l2_buf_type</a></td>          <td class="paramname"><span class="paramname"><em>buf_type</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="#a503cae4db48721184bb9f07e65829ef2">enum</a> <a class="el" href="#a503cae4db48721184bb9f07e65829ef2">v4l2_memory</a></td>          <td class="paramname"><span class="paramname"><em>memory_type</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="#a503cae4db48721184bb9f07e65829ef2">uint32_t</a></td>          <td class="paramname"><span class="paramname"><em>n_planes</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structBuffer_1_1BufferPlaneFormat.html">BufferPlaneFormat</a> *</td>          <td class="paramname"><span class="paramname"><em>fmt</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="#a503cae4db48721184bb9f07e65829ef2">uint32_t</a></td>          <td class="paramname"><span class="paramname"><em>index</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classBuffer_a6a53ef7b2ce3def1c2ecc85cf16257a1_cgraph.png" border="0" usemap="#aclassBuffer_a6a53ef7b2ce3def1c2ecc85cf16257a1_cgraph" alt=""/></div>
<map name="aclassBuffer_a6a53ef7b2ce3def1c2ecc85cf16257a1_cgraph" id="aclassBuffer_a6a53ef7b2ce3def1c2ecc85cf16257a1_cgraph">
<area shape="rect" title=" " alt="" coords="5,29,101,55"/>
<area shape="rect" href="classBuffer.html#a503cae4db48721184bb9f07e65829ef2" title=" " alt="" coords="149,29,235,55"/>
<area shape="poly" title=" " alt="" coords="101,40,133,40,133,45,101,45"/>
<area shape="poly" title=" " alt="" coords="168,30,163,21,166,11,176,5,192,3,209,5,218,12,215,16,207,10,192,8,178,10,170,14,169,20,172,28"/>
</map>
</div>

</div>
</div>
<a id="a59b8743e4a5f731bdd0c4185c9ef263b" name="a59b8743e4a5f731bdd0c4185c9ef263b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59b8743e4a5f731bdd0c4185c9ef263b">&#9670;&#160;</a></span>~Buffer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Buffer::~Buffer </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classBuffer_a59b8743e4a5f731bdd0c4185c9ef263b_cgraph.png" border="0" usemap="#aclassBuffer_a59b8743e4a5f731bdd0c4185c9ef263b_cgraph" alt=""/></div>
<map name="aclassBuffer_a59b8743e4a5f731bdd0c4185c9ef263b_cgraph" id="aclassBuffer_a59b8743e4a5f731bdd0c4185c9ef263b_cgraph">
<area shape="rect" title=" " alt="" coords="5,29,108,55"/>
<area shape="rect" href="classBuffer.html#aaeecba2e74f8797e81816c433f7d573e" title=" " alt="" coords="156,29,256,55"/>
<area shape="poly" title=" " alt="" coords="108,40,140,40,140,45,108,45"/>
<area shape="rect" href="classBuffer.html#a503cae4db48721184bb9f07e65829ef2" title=" " alt="" coords="304,29,390,55"/>
<area shape="poly" title=" " alt="" coords="256,40,288,40,288,45,256,45"/>
<area shape="poly" title=" " alt="" coords="323,30,318,21,321,11,331,5,347,3,365,5,374,12,371,16,363,10,347,8,333,10,325,14,323,20,327,28"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a6002af2b41087f5cd575e6f49b5a0ea8" name="a6002af2b41087f5cd575e6f49b5a0ea8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6002af2b41087f5cd575e6f49b5a0ea8">&#9670;&#160;</a></span>fill_buffer_plane_format()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="#a503cae4db48721184bb9f07e65829ef2">int</a> Buffer::fill_buffer_plane_format </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="#a503cae4db48721184bb9f07e65829ef2">uint32_t</a> *</td>          <td class="paramname"><span class="paramname"><em>num_planes</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structBuffer_1_1BufferPlaneFormat.html">Buffer::BufferPlaneFormat</a> *</td>          <td class="paramname"><span class="paramname"><em>planefmts</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="#a503cae4db48721184bb9f07e65829ef2">uint32_t</a></td>          <td class="paramname"><span class="paramname"><em>width</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="#a503cae4db48721184bb9f07e65829ef2">uint32_t</a></td>          <td class="paramname"><span class="paramname"><em>height</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="#a503cae4db48721184bb9f07e65829ef2">uint32_t</a></td>          <td class="paramname"><span class="paramname"><em>raw_pixfmt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Fills the <a class="el" href="structBuffer_1_1BufferPlaneFormat.html">Buffer::BufferPlaneFormat</a> array. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classBuffer_a6002af2b41087f5cd575e6f49b5a0ea8_cgraph.png" border="0" usemap="#aclassBuffer_a6002af2b41087f5cd575e6f49b5a0ea8_cgraph" alt=""/></div>
<map name="aclassBuffer_a6002af2b41087f5cd575e6f49b5a0ea8_cgraph" id="aclassBuffer_a6002af2b41087f5cd575e6f49b5a0ea8_cgraph">
<area shape="rect" title=" " alt="" coords="5,22,118,63"/>
<area shape="rect" href="classBuffer.html#a503cae4db48721184bb9f07e65829ef2" title=" " alt="" coords="166,29,252,55"/>
<area shape="poly" title=" " alt="" coords="118,40,150,40,150,45,118,45"/>
<area shape="poly" title=" " alt="" coords="183,30,179,21,182,11,192,5,209,3,227,5,237,12,233,16,225,10,209,8,194,10,186,14,184,20,188,28"/>
</map>
</div>

</div>
</div>
<a id="a503cae4db48721184bb9f07e65829ef2" name="a503cae4db48721184bb9f07e65829ef2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a503cae4db48721184bb9f07e65829ef2">&#9670;&#160;</a></span>map()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Buffer::map </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Maps the contents of the buffer to memory.</p>
<p>This method maps the file descriptor (FD) of the planes to a data pointer of <code>planes</code>. (MMAP buffers only.) </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classBuffer_a503cae4db48721184bb9f07e65829ef2_cgraph.png" border="0" usemap="#aclassBuffer_a503cae4db48721184bb9f07e65829ef2_cgraph" alt=""/></div>
<map name="aclassBuffer_a503cae4db48721184bb9f07e65829ef2_cgraph" id="aclassBuffer_a503cae4db48721184bb9f07e65829ef2_cgraph">
<area shape="rect" title=" " alt="" coords="5,29,92,55"/>
<area shape="poly" title=" " alt="" coords="32,29,31,12,38,5,49,3,60,5,66,12,62,15,57,10,48,8,40,10,36,14,38,29"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classBuffer_a503cae4db48721184bb9f07e65829ef2_icgraph.png" border="0" usemap="#aclassBuffer_a503cae4db48721184bb9f07e65829ef2_icgraph" alt=""/></div>
<map name="aclassBuffer_a503cae4db48721184bb9f07e65829ef2_icgraph" id="aclassBuffer_a503cae4db48721184bb9f07e65829ef2_icgraph">
<area shape="rect" title=" " alt="" coords="809,112,895,138"/>
<area shape="poly" title=" " alt="" coords="876,99,868,93,852,91,837,93,829,97,827,103,831,110,826,113,822,103,825,94,835,88,852,85,870,88,880,95"/>
<area shape="rect" href="classBuffer.html#a1705f0bb0cd761c436631af24e0242ca" title=" " alt="" coords="657,5,752,31"/>
<area shape="poly" title=" " alt="" coords="827,103,796,73,759,44,740,34,742,29,762,40,800,69,831,99"/>
<area shape="rect" href="classBuffer.html#a6a53ef7b2ce3def1c2ecc85cf16257a1" title=" " alt="" coords="657,55,752,80"/>
<area shape="poly" title=" " alt="" coords="802,108,739,83,741,78,804,103"/>
<area shape="rect" href="classBuffer.html#a6002af2b41087f5cd575e6f49b5a0ea8" title=" " alt="" coords="648,105,761,145"/>
<area shape="poly" title=" " alt="" coords="793,128,761,128,761,122,793,122"/>
<area shape="rect" href="classh264DecoderV4L2Helper.html#ac7b5fa188d9fdf7ce3e24ae1e4e19a19" title=" " alt="" coords="5,223,172,264"/>
<area shape="poly" title=" " alt="" coords="805,146,761,159,644,181,483,202,173,238,172,232,483,197,643,175,760,154,803,141"/>
<area shape="rect" href="classBuffer.html#aaeecba2e74f8797e81816c433f7d573e" title=" " alt="" coords="654,259,755,284"/>
<area shape="poly" title=" " alt="" coords="829,150,721,260,717,256,825,147"/>
<area shape="rect" href="classh264DecoderV4L2Helper.html#ad1b518b5ac557eb749946e6a10a8fbc5" title=" " alt="" coords="434,219,600,260"/>
<area shape="poly" title=" " alt="" coords="638,263,600,256,601,251,639,258"/>
<area shape="rect" href="classh264DecoderV4L2Helper.html#abf17c07f4b3f52ab4915be71a4e9719e" title="Query and Set Capture plane." alt="" coords="434,285,600,325"/>
<area shape="poly" title=" " alt="" coords="639,286,601,293,600,287,638,281"/>
<area shape="rect" href="classBuffer.html#a59b8743e4a5f731bdd0c4185c9ef263b" title=" " alt="" coords="466,349,568,375"/>
<area shape="poly" title=" " alt="" coords="675,296,641,318,601,339,570,351,568,346,599,334,638,314,672,291"/>
<area shape="rect" href="classh264DecoderV4L2Helper.html#a5c5f98ec229ff06bde7717be614ed545" title="Callback function on capture thread." alt="" coords="220,251,386,292"/>
<area shape="poly" title=" " alt="" coords="418,292,386,287,387,282,419,287"/>
<area shape="poly" title=" " alt="" coords="204,261,172,257,172,252,204,256"/>
</map>
</div>

</div>
</div>
<a id="aaeecba2e74f8797e81816c433f7d573e" name="aaeecba2e74f8797e81816c433f7d573e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaeecba2e74f8797e81816c433f7d573e">&#9670;&#160;</a></span>unmap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="#a503cae4db48721184bb9f07e65829ef2">void</a> Buffer::unmap </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Unmaps the contents of the buffer from memory. (MMAP buffers only.) </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classBuffer_aaeecba2e74f8797e81816c433f7d573e_cgraph.png" border="0" usemap="#aclassBuffer_aaeecba2e74f8797e81816c433f7d573e_cgraph" alt=""/></div>
<map name="aclassBuffer_aaeecba2e74f8797e81816c433f7d573e_cgraph" id="aclassBuffer_aaeecba2e74f8797e81816c433f7d573e_cgraph">
<area shape="rect" title=" " alt="" coords="5,29,106,55"/>
<area shape="rect" href="classBuffer.html#a503cae4db48721184bb9f07e65829ef2" title=" " alt="" coords="154,29,240,55"/>
<area shape="poly" title=" " alt="" coords="106,40,138,40,138,45,106,45"/>
<area shape="poly" title=" " alt="" coords="172,30,168,21,171,11,181,5,197,3,214,5,223,12,220,16,212,10,197,8,182,10,175,14,173,20,177,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classBuffer_aaeecba2e74f8797e81816c433f7d573e_icgraph.png" border="0" usemap="#aclassBuffer_aaeecba2e74f8797e81816c433f7d573e_icgraph" alt=""/></div>
<map name="aclassBuffer_aaeecba2e74f8797e81816c433f7d573e_icgraph" id="aclassBuffer_aaeecba2e74f8797e81816c433f7d573e_icgraph">
<area shape="rect" title=" " alt="" coords="648,78,749,104"/>
<area shape="rect" href="classh264DecoderV4L2Helper.html#ad1b518b5ac557eb749946e6a10a8fbc5" title=" " alt="" coords="434,5,600,46"/>
<area shape="poly" title=" " alt="" coords="646,75,575,49,577,44,648,70"/>
<area shape="rect" href="classh264DecoderV4L2Helper.html#abf17c07f4b3f52ab4915be71a4e9719e" title="Query and Set Capture plane." alt="" coords="434,71,600,111"/>
<area shape="poly" title=" " alt="" coords="633,94,601,94,601,88,633,88"/>
<area shape="rect" href="classBuffer.html#a59b8743e4a5f731bdd0c4185c9ef263b" title=" " alt="" coords="466,136,568,161"/>
<area shape="poly" title=" " alt="" coords="644,112,601,126,563,137,561,132,600,120,642,107"/>
<area shape="rect" href="classh264DecoderV4L2Helper.html#a5c5f98ec229ff06bde7717be614ed545" title="Callback function on capture thread." alt="" coords="220,71,386,111"/>
<area shape="poly" title=" " alt="" coords="418,94,386,94,386,88,418,88"/>
<area shape="rect" href="classh264DecoderV4L2Helper.html#ac7b5fa188d9fdf7ce3e24ae1e4e19a19" title=" " alt="" coords="5,71,172,111"/>
<area shape="poly" title=" " alt="" coords="204,94,172,94,172,88,204,88"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a2765e361092daf74ecf5892d19807f54" name="a2765e361092daf74ecf5892d19807f54"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2765e361092daf74ecf5892d19807f54">&#9670;&#160;</a></span>buf_type</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="#a503cae4db48721184bb9f07e65829ef2">enum</a> <a class="el" href="#a503cae4db48721184bb9f07e65829ef2">v4l2_buf_type</a> Buffer::buf_type</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Type of the buffer. </p>

</div>
</div>
<a id="a2b2a909b1bef94995dc0cdad022d8505" name="a2b2a909b1bef94995dc0cdad022d8505"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b2a909b1bef94995dc0cdad022d8505">&#9670;&#160;</a></span>index</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="#a503cae4db48721184bb9f07e65829ef2">uint32_t</a> Buffer::index</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Holds the buffer index. </p>

</div>
</div>
<a id="a000d51a210f48a064afc1e2b4db1482b" name="a000d51a210f48a064afc1e2b4db1482b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a000d51a210f48a064afc1e2b4db1482b">&#9670;&#160;</a></span>mapped</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="#a503cae4db48721184bb9f07e65829ef2">bool</a> Buffer::mapped</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a7a3e9a3e9657d4fa4e2c3eb6f88e234b" name="a7a3e9a3e9657d4fa4e2c3eb6f88e234b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a3e9a3e9657d4fa4e2c3eb6f88e234b">&#9670;&#160;</a></span>memory_type</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="#a503cae4db48721184bb9f07e65829ef2">enum</a> <a class="el" href="#a503cae4db48721184bb9f07e65829ef2">v4l2_memory</a> Buffer::memory_type</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Type of memory associated with the buffer. </p>

</div>
</div>
<a id="a08a43c825b6c73f0cb3c7771f5629a1a" name="a08a43c825b6c73f0cb3c7771f5629a1a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a08a43c825b6c73f0cb3c7771f5629a1a">&#9670;&#160;</a></span>n_planes</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="#a503cae4db48721184bb9f07e65829ef2">uint32_t</a> Buffer::n_planes</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Holds the number of planes in the buffer. </p>

</div>
</div>
<a id="a95709171c4c8c9dfa7991bceec271e15" name="a95709171c4c8c9dfa7991bceec271e15"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95709171c4c8c9dfa7991bceec271e15">&#9670;&#160;</a></span>planes</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structBuffer_1_1BufferPlane.html">BufferPlane</a> Buffer::planes[MAX_PLANES]</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Holds the data pointer, plane file descriptor (FD), plane format, etc. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>base/src/<a class="el" href="H264DecoderV4L2Helper_8h_source.html">H264DecoderV4L2Helper.h</a></li>
<li>base/src/<b>H264DecoderV4L2Helper.cpp</b></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
    <ul>
      <li class="navelem"><a class="el" href="classBuffer.html">Buffer</a></li>
      <li class="footer"><a href="https://github.com/Apra-Labs/ApraPipes/commits/main/">Source Commit: 221719b</a></li>
    </ul>
  </div>
  </body>
  </html>
