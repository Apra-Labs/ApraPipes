# 11_motion_vector_pipeline.toml
# Extracts motion vectors from H.264 video for motion analysis
# Chain: Mp4ReaderSource → MotionVectorExtractor → StatSink
#
# This pipeline demonstrates:
# - Reading H.264 encoded video from MP4 file
# - Motion vector extraction for activity detection
# - Different extraction methods (FFMPEG vs OpenH264)
#
# IMPORTANT: This is a TEMPLATE pipeline.
# - Replace /path/to/video.mp4 with an actual H.264 encoded video file
# - Validation and run both require a valid video file to exist
# - The Mp4ReaderSource module creates output pins based on actual MP4 content

[pipeline]
name = "Motion Vector Extraction Pipeline"
description = "Extracts motion vectors from H.264 video for motion analysis"

# Read H.264 frames from MP4 file
[modules.reader]
type = "Mp4ReaderSource"
  [modules.reader.props]
  videoPath = "/path/to/video.mp4"  # REPLACE with actual video path
  parseFS = true
  readLoop = false

# Extract motion vectors using FFMPEG method
# Alternative: use "OPENH264" for OpenH264-based extraction
[modules.motion]
type = "MotionVectorExtractor"
  [modules.motion.props]
  MVExtractMethod = "FFMPEG"
  sendDecodedFrame = false      # Set true to also output decoded frames
  motionVectorThreshold = 2     # Minimum motion magnitude to report

# Collect statistics on motion vector output
[modules.stats]
type = "StatSink"

[[connections]]
from = "reader"
to = "motion"

[[connections]]
from = "motion"
to = "stats"
