{
  "hooks": {
    "SessionStart": [
      {
        "hooks": [
          {
            "type": "command",
            "command": "echo '‚ïê‚ïê‚ïê INSTITUTIONAL MEMORY ‚ïê‚ïê‚ïê'; cat .claude/LEARNINGS.md 2>/dev/null | tail -60 || echo '(no learnings yet)'; echo ''; echo '‚ïê‚ïê‚ïê CURRENT STATE ‚ïê‚ïê‚ïê'; cat .claude/CURRENT_STATE.md 2>/dev/null || echo '(no state file)'; echo '‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê'"
          }
        ]
      }
    ],
    "PostToolUse": [
      {
        "matcher": "Bash",
        "hooks": [
          {
            "type": "command",
            "command": "bash -c 'CMD=\"$TOOL_INPUT\"; if echo \"$CMD\" | grep -qE \"git push|gh workflow run\"; then if ! echo \"$CMD\" | grep -q \"gh run watch\"; then echo \"‚ö† WORKFLOW TRIGGERED WITHOUT WATCH. Run: gh run watch $(gh run list -L1 --json databaseId -q .[0].databaseId) --exit-status\" >&2; fi; fi; if echo \"$CMD\" | grep -qE \"gh run watch|gh run view.*--log\"; then echo \"üìù Update CURRENT_STATE.md with results. New lesson? ‚Üí LEARNINGS.md\"; fi'"
          }
        ]
      }
    ],
    "Stop": [
      {
        "hooks": [
          {
            "type": "prompt",
            "prompt": "Before stopping, verify: (1) Is CURRENT_STATE.md updated with latest status? (2) If a build completed, are results documented? (3) If something new was learned, is it in LEARNINGS.md? (4) Are there pending workflow runs? Check with: gh run list -L3 --json status,databaseId -q '.[] | select(.status==\"in_progress\" or .status==\"queued\")'. If state not saved or builds pending, handle that first then continue. If task is complete and state is saved, you may stop."
          }
        ]
      }
    ]
  }
}
